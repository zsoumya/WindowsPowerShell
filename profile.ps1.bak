Set-StrictMode -Version Latest

Import-Module -Name Soumya.Utilities

. (Join-Path $PSScriptRoot ColorUtils.ps1)

function Prompt {
    try {
        $userName = [System.Environment]::UserName
        $computerName = [System.Environment]::MachineName
        $promptString = ('$' * ($nestedPromptLevel + 1)) + ' '
        $newLine = [System.Environment]::NewLine
        $bit = @{ $True = 'x64'; $False = 'x86' }[[System.Environment]::Is64BitProcess]
        $label = if ($PSVersionTable.PSEdition -eq "Core") { "PWSH" } else { "PS" }

        return `
            $(colorize $([MyConsoleColors]::FGWhite) "$label") + `
            $(colorize $([MyConsoleColors]::FGCyanBold) "$bit") + `
            $(colorize $([MyConsoleColors]::Reset) " ") + `
            # $(colorize $([MyConsoleColors]::Reset) " [") + `
            # $(colorize $([MyConsoleColors]::FGRedBold) $userName) + `
            # $(colorize $([MyConsoleColors]::Reset) "@") + `
            # $(colorize $([MyConsoleColors]::FGGreenBold) $computerName) + `
            # $(colorize $([MyConsoleColors]::Reset) "] ") + `
            $(colorize $([MyConsoleColors]::FGPurpleBold) $(shortenCurrentPath)) + `
            $(colorize $([MyConsoleColors]::Reset) $newLine) + `
            $(colorize $([MyConsoleColors]::FGGreenBold) $promptString)
    }
    catch {
        Write-Host "An error occurred:"
        Write-Host $_
    }
}
